package boot.data.service;

import java.io.IOException;

import javax.servlet.http.HttpSession;

import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestPart;
import org.springframework.web.multipart.MultipartFile;

import boot.data.dto.MemberDto;
import lombok.RequiredArgsConstructor;

@Service
@Transactional
@RequiredArgsConstructor
public class UpdateService {

	private final MemberService mservice;

	private final S3Service s3Service;

	/*
	 * public String updateUser(String member_num,String member_nickname,MemberDto
	 * dto,MultipartFile image, HttpSession session) throws IOException { String
	 * loginemail = (String) session.getAttribute("loginemail"); String member_num =
	 * mservice.findEmailMemberNum(loginemail);
	 * 
	 * if (!image.isEmpty()){
	 * 
	 * 
	 * String profileImages = s3Service.upload(image, "profileImages");
	 * loginemail.update(member_nickname,profileImages); }else
	 * 
	 * return "redirect:/myinfo"; }
	 */
	@PostMapping("/s3/upload")
	public ResponseEntity<?> s3Upload(@RequestPart(value = "image", required = false) MultipartFile image){
	  String profileImage = s3Service.upload(image);
	  return ResponseEntity.ok(profileImage);
	}

	
}
